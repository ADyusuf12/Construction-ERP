  <!-- SIDEBAR -->
<aside class="w-64 bg-hamzis-brown text-hamzis-white dark:bg-hamzis-black dark:text-hamzis-copper min-h-screen flex flex-col">
  <!-- Logo -->
  <div class="px-4 py-6 border-b border-hamzis-brown/20 flex justify-between items-center">
    <h1 class="text-xl font-bold tracking-wide">Hamzis Systems</h1>
    <!-- Mobile toggle -->
    <button id="nav-toggle"
            class="md:hidden px-2 py-1 rounded bg-hamzis-copper text-hamzis-white
                   hover:bg-hamzis-black hover:text-hamzis-white transition-colors"
            aria-label="Toggle navigation">
      â˜°
    </button>
  </div>
  <!-- Nav links -->
  <nav id="nav-menu" class="flex-1 px-4 py-6 space-y-4 hidden md:block text-sm">
    <!-- Home -->
    <%= link_to root_path, class: "flex items-center px-3 py-2 rounded transition-colors #{current_page?(root_path) ? 'bg-hamzis-copper text-hamzis-white' : 'hover:bg-hamzis-copper hover:text-hamzis-white'}" do %>
      <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7m-9 2v8m0-8h8" />
      </svg>
      Home
    <% end %>
    <!-- Projects section -->
    <div class="space-y-2">
      <span class="block px-3 py-1 text-xs font-semibold tracking-wider text-hamzis-copper uppercase border-b border-hamzis-brown/30">Operations</span>
      <% if user_signed_in? && policy(Project).index? %>
        <div class="ml-4 space-y-1">
          <button type="button"
              class="flex justify-between items-center w-full px-3 py-2 rounded hover:bg-hamzis-copper hover:text-hamzis-white"
              onclick="document.getElementById('projects-dropdown').classList.toggle('hidden')">
            <span class="flex items-center">
              <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-6h6v6h5v2H4v-2h5z" />
              </svg>
              Projects
            </span>
            <svg class="w-4 h-4 transform transition-transform" id="projects-chevron" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div id="projects-dropdown" class="ml-4 space-y-1 hidden">
            <%= link_to "All Projects", projects_path,
            class: "block px-3 py-2 rounded transition-colors #{current_page?(projects_path) ? 'bg-hamzis-copper text-hamzis-white' : 'hover:bg-hamzis-copper hover:text-hamzis-white'}" %>
            <% if policy(Project).create? %>
              <%= link_to "New Project", new_project_path,
              class: "block px-3 py-2 rounded transition-colors #{current_page?(new_project_path) ? 'bg-hamzis-copper text-hamzis-white' : 'hover:bg-hamzis-copper hover:text-hamzis-white'}" %>
            <% end %>
          </div>
        </div>
      <% end %>
      <% if user_signed_in? && policy(Task).index? %>
        <div class="ml-4 space-y-1">
          <button type="button"
              class="flex justify-between items-center w-full px-3 py-2 rounded hover:bg-hamzis-copper hover:text-hamzis-white"
              onclick="document.getElementById('tasks-dropdown').classList.toggle('hidden')">
            <span class="flex items-center">
              <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m-6-8h6" />
              </svg>
              Tasks
            </span>
            <svg class="w-4 h-4 transform transition-transform" id="tasks-chevron" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div id="tasks-dropdown" class="ml-4 space-y-1 hidden">
            <%= link_to "All Tasks", tasks_path,
            class: "block px-3 py-2 rounded transition-colors #{current_page?(tasks_path) ? 'bg-hamzis-copper text-hamzis-white' : 'hover:bg-hamzis-copper hover:text-hamzis-white'}" %>
            <% if policy(Task).create? %>
              <%= link_to "New Task", new_task_path,
              class: "block px-3 py-2 rounded transition-colors #{current_page?(new_task_path) ? 'bg-hamzis-copper text-hamzis-white' : 'hover:bg-hamzis-copper hover:text-hamzis-white'}" %>
            <% end %>
          </div>
        </div>
      <% end %>
      <% if user_signed_in? && policy_scope(Report).exists? %>
        <div class="ml-4 space-y-1">
          <button type="button"
              class="flex justify-between items-center w-full px-3 py-2 rounded hover:bg-hamzis-copper hover:text-hamzis-white"
              onclick="document.getElementById('reports-dropdown').classList.toggle('hidden')">
            <span class="flex items-center">
              <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
              </svg>
              Reports
            </span>
            <svg class="w-4 h-4 transform transition-transform" id="reports-chevron" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div id="reports-dropdown" class="ml-4 space-y-1 hidden">
            <%= link_to "All Reports", reports_path,
            class: "block px-3 py-2 rounded transition-colors #{current_page?(reports_path) ? 'bg-hamzis-copper text-hamzis-white' : 'hover:bg-hamzis-copper hover:text-hamzis-white'}" %>
            <% if policy(Report.new).create? %>
              <%= link_to "New Report", new_report_path,
              class: "block px-3 py-2 rounded transition-colors #{current_page?(new_report_path) ? 'bg-hamzis-copper text-hamzis-white' : 'hover:bg-hamzis-copper hover:text-hamzis-white'}" %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
    <!-- HR section -->
    <% if user_signed_in? && policy(Hr::Employee).index? %>
      <div class="space-y-2">
        <span class="block px-3 py-1 text-xs font-semibold tracking-wider text-hamzis-copper uppercase border-b border-hamzis-brown/30">HR</span>
        <div class="ml-4 space-y-1">
          <button type="button"
                  class="flex justify-between items-center w-full px-3 py-2 rounded hover:bg-hamzis-copper hover:text-hamzis-white"
                  onclick="document.getElementById('hr-dropdown').classList.toggle('hidden')">
            <span class="flex items-center">
              <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5.121 17.804A9 9 0 1118.879 6.196 9 9 0 015.121 17.804z" />
              </svg>
              Employees
            </span>
            <svg class="w-4 h-4 transform transition-transform" id="hr-chevron" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div id="hr-dropdown" class="ml-4 space-y-1 hidden">
            <%= link_to "All Employees", hr_employees_path,
                class: "block px-3 py-2 rounded transition-colors #{current_page?(hr_employees_path) ? 'bg-hamzis-copper text-hamzis-white' : 'hover:bg-hamzis-copper hover:text-hamzis-white'}" %>
            <% if user_signed_in? && policy(Hr::Employee).create? %>
              <%= link_to "New Employee", new_hr_employee_path,
                  class: "block px-3 py-2 rounded transition-colors #{current_page?(new_hr_employee_path) ? 'bg-hamzis-copper text-hamzis-white' : 'hover:bg-hamzis-copper hover:text-hamzis-white'}" %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
    <!-- Accounting section -->
    <% if user_signed_in? && policy(Transaction).index? %>
      <div class="space-y-2">
        <span class="block px-3 py-1 text-xs font-semibold tracking-wider text-hamzis-copper uppercase border-b border-hamzis-brown/30">Accounting</span>
        <div class="ml-4 space-y-1">
          <button type="button"
                  class="flex justify-between items-center w-full px-3 py-2 rounded hover:bg-hamzis-copper hover:text-hamzis-white"
                  onclick="document.getElementById('transactions-dropdown').classList.toggle('hidden')">
            <span class="flex items-center">
              <svg class="w-5 h-5 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 1.343-3 3h6c0-1.657-1.343-3-3-3zm0 6c1.657 0 3-1.343 3-3H9c0 1.657 1.343 3 3 3z" />
              </svg>
              Transactions
            </span>
            <svg class="w-4 h-4 transform transition-transform" id="transactions-chevron" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div id="transactions-dropdown" class="ml-4 space-y-1 hidden">
            <%= link_to "All Transactions", transactions_path,
                class: "block px-3 py-2 rounded transition-colors #{current_page?(transactions_path) ? 'bg-hamzis-copper text-hamzis-white' : 'hover:bg-hamzis-copper hover:text-hamzis-white'}" %>
            <% if user_signed_in? && policy(Transaction).create? %>
              <%= link_to "New Transaction", new_transaction_path,
                  class: "block px-3 py-2 rounded transition-colors #{current_page?(new_transaction_path) ? 'bg-hamzis-copper text-hamzis-white' : 'hover:bg-hamzis-copper hover:text-hamzis-white'}" %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  </nav>
  <%= render 'shared/auth_links' %>
</aside>