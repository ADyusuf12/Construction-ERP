<% if user_signed_in? && (policy(Project).index? || policy(Task).index? || policy_scope(Report).exists?) %>
  <div class="space-y-4 py-2">
    <!-- Section Header: Matching the Table Header style -->
    <div class="px-3">
      <span class="block text-[10px] font-black uppercase tracking-[0.3em] text-hamzis-brown/70 dark:text-white border-b border-hamzis-brown/10 dark:border-hamzis-copper/10 pb-1 mb-2">
        Operations
      </span>
    </div>
    <div class="px-2 space-y-1">
      <%# Mapping the items to keep the code clean and consistent %>
      <% [
        { id: 'projects', label: 'Projects', icon: 'M3 7h4l2-2h10a2 2 0 012 2v12a2 2 0 01-2 2H5a2 2 0 01-2-2V7z',
          links: [{l: 'All Projects', p: projects_path}, {l: 'New Project', p: new_project_path, auth: policy(Project).create?}] },

        { id: 'tasks', label: 'Tasks', icon: 'M9 11l3 3L22 4M4 6h16M4 12h4M4 18h4',
          links: [{l: 'All Tasks', p: tasks_path}, {l: 'New Task', p: new_task_path, auth: policy(Task).create?}] },

        { id: 'reports', label: 'Reports', icon: 'M4 6h4v12H4V6zm6 4h4v8h-4v-8zm6-6h4v14h-4V4z',
          links: [{l: 'All Reports', p: reports_path}, {l: 'New Report', p: new_report_path, auth: policy(Report.new).create?}] }
      ].each do |item| %>
        <div class="group">
          <%# Dropdown Toggle: Brutalist button style %>
          <button type="button"
                  class="flex justify-between items-center w-full px-3 py-2.5 rounded-xl border border-transparent hover:bg-hamzis-brown/5 dark:hover:bg-hamzis-copper/5 transition-all duration-300"
                  onclick="document.getElementById('<%= item[:id] %>-dropdown').classList.toggle('hidden')">
            <span class="flex items-center">
              <svg class="w-4 h-4 mr-3 text-hamzis-brown/70 dark:text-hamzis-copper/70 group-hover:text-hamzis-copper transition-colors" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                <path stroke-linecap="round" stroke-linejoin="round" d="<%= item[:icon] %>" />
              </svg>
              <span class="text-[11px] font-black uppercase tracking-widest text-hamzis-brown dark:text-hamzis-copper">
                <%= item[:label] %>
              </span>
                </span>
                <svg class="w-3 h-3 text-hamzis-brown/30 dark:text-hamzis-copper/30 group-hover:text-hamzis-copper transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                  <path d="M19 9l-7 7-7-7" />
                </svg>
              </button>
              <%# Dropdown Content: Clean vertical indicator %>
              <div id="<%= item[:id] %>-dropdown" class="ml-9 mt-1 space-y-1 border-l-2 border-hamzis-brown/10 dark:border-hamzis-copper/10 hidden">
                <% item[:links].each do |link| %>
                  <% if link[:auth] != false %>
                    <%= link_to link[:p],
                    class: "flex items-center px-4 py-2 text-[10px] font-bold uppercase tracking-widest transition-all
                    #{current_page?(link[:p]) ?
                      'text-hamzis-copper border-l-2 border-hamzis-copper -ml-[2px] bg-hamzis-copper/5' :
                      'text-hamzis-brown/50 dark:text-hamzis-copper/40 hover:text-hamzis-brown dark:hover:text-white hover:bg-hamzis-brown/5'}" do %>
                      <%= link[:l] %>
                    <% end %>
                  <% end %>
                <% end %>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    <% end %>
