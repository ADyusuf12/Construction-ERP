<div id="<%= dom_id(notification) %>" class="relative group border-b border-brand-secondary/5">
  <%# Main Redirect Link %>
  <%= link_to notification_path(notification),
              data: { turbo_method: :patch, turbo_frame: "_top" },
              class: "block group" do %>
    <div class="px-4 py-4 hover:bg-brand-secondary/5 transition-all relative <%= 'opacity-50 grayscale-[0.5]' if notification.read? %>">
      <div class="flex gap-3 pr-6"> <%# Added pr-6 to avoid overlapping the X %>
        <div class="mt-0.5">
          <% case notification.action %>
          <% when 'report_submitted' %>
            <svg class="w-4 h-4 text-brand-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m3-9h3.375c.621 0 1.125.504 1.125 1.125V18a2.25 2.25 0 01-2.25 2.25H5.25A2.25 2.25 0 013 18V6a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 6v1.5m-3.5 7h-.008v.008H17.5V14.5zm0-3h-.008v.008H17.5V11.5z" />
            </svg>
          <% when 'report_reviewed' %>
            <svg class="w-4 h-4 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
              <path stroke-linecap="round" stroke-linejoin="round" d="M10.125 2.25h-4.5c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125v-9M10.125 2.25l7.5 7.5m-7.5-7.5v7.5h7.5m-7.462 4.34a2.25 2.25 0 101.92 2.54m-1.285-1.341a12.86 12.86 0 004.704-2.89l.456-.456a.81.81 0 011.14 0l1.14 1.14a.81.81 0 010 1.14l-.456.456a12.86 12.86 0 00-2.89 4.704" />
            </svg>
          <% when 'low_stock' %>
            <svg class="w-4 h-4 text-amber-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" /></svg>
          <% when 'leave_approved', 'leave_requested' %>
            <svg class="w-4 h-4 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
          <% when 'task_assigned' %>
            <svg class="w-4 h-4 text-brand-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" /></svg>
          <% when 'movement_recorded' %>
            <svg class="w-4 h-4 text-blue-500" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6" /></svg>
          <% else %>
            <svg class="w-4 h-4 text-brand-primary" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5"><path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
          <% end %>
        </div>
        <div class="flex-1">
          <p class="text-[11px] font-bold text-brand-secondary dark:text-white leading-tight mb-1">
            <%= notification.message %>
          </p>
          <div class="flex items-center gap-2">
            <span class="text-[8px] font-black uppercase tracking-widest text-brand-secondary/30 dark:text-brand-primary/30">
              <%= notification.action.humanize %>
            </span>
            <span class="text-[8px] text-brand-secondary/20">â€¢</span>
            <span class="text-[9px] text-brand-secondary/40 font-medium italic">
              <%= time_ago_in_words(notification.created_at) %> ago
            </span>
          </div>
        </div>
      </div>
      <% unless notification.read? %>
        <div class="absolute top-5 right-4 h-1.5 w-1.5 rounded-full bg-brand-primary shadow-[0_0_8px_rgba(var(--brand-primary-rgb),0.6)]"></div>
      <% end %>
    </div>
  <% end %>
  <%# Small Dismiss "X" Button (Read Only) %>
  <% unless notification.read? %>
    <%= button_to notification_path(notification, read_only: true),
                 method: :patch,
                 class: "absolute top-4 right-3 p-1 rounded hover:bg-brand-secondary/10 text-brand-secondary/20 hover:text-brand-primary transition-colors z-20",
                 data: { turbo_stream: true } do %>
      <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
      </svg>
    <% end %>
  <% end %>
</div>