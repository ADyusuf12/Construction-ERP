<%# app/views/dashboard/_expenses_tab.html.erb %>
<% if policy_scope(ProjectExpense).any? %>
  <div class="space-y-6">
    <div class="flex items-center justify-between mb-4">
      <div>
        <h2 class="text-xl font-black text-brand-secondary dark:text-brand-primary uppercase tracking-tight">Financial Outflow</h2>
        <p class="text-[9px] font-bold uppercase tracking-widest text-brand-secondary/40">Real-time Project Expenditure & Capital Allocation</p>
      </div>
      <div class="flex items-center gap-3">
        <div class="px-3 py-1 rounded-lg bg-red-500/10 border border-red-500/20 text-red-500 text-[10px] font-black uppercase tracking-widest">
          Total Outflow This Period: <%= number_to_currency(@expenses.sum(:amount), unit: "â‚¦", precision: 0) %>
        </div>
      </div>
    </div>
    <div class="overflow-hidden bg-brand-white/30 dark:bg-brand-black/30 backdrop-blur-md border border-brand-secondary/20 rounded-2xl shadow-2xl">
      <% if expenses.any? %>
        <div class="overflow-x-auto custom-scrollbar">
          <table class="min-w-full text-left border-separate border-spacing-0">
            <thead>
              <%# Reusing your Modular Header %>
              <%= render "project_expenses/expenses_header", show_project: true %>
            </thead>
            <tbody class="divide-y divide-brand-secondary/10 dark:divide-brand-primary/10">
              <% expenses.each_with_index do |expense, index| %>
                <%# Reusing your rich Expense Row with reference tags and actions %>
                <%= render "project_expenses/expense_row",
                           expense: expense,
                           show_project: true,
                           row_class: index.even? ? "bg-brand-secondary/5 dark:bg-brand-primary/5" : "" %>
              <% end %>
            </tbody>
          </table>
        </div>
      <% else %>
        <div class="text-center py-20 bg-black/5 rounded-xl border border-dashed border-brand-secondary/20">
          <h3 class="text-xl font-black text-brand-secondary dark:text-brand-primary uppercase tracking-tighter italic opacity-50">No Expenditure Logged</h3>
          <p class="text-[10px] text-white/30 mt-2 uppercase tracking-widest italic">Financial ledger currently blank for this cycle.</p>
        </div>
      <% end %>
    </div>
  </div>
<% end %>