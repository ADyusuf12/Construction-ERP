<%# 1. Update the Row in the Table (for Index) %>
<%= turbo_stream.replace dom_id(@report) do %>
  <%
    collection = @report.project.reports.order(created_at: :desc)
    index = collection.pluck(:id).index(@report.id) || 0
    row_class = (index.even? ? "bg-brand-secondary/5 dark:bg-brand-primary/5" : "")
  %>
  <%= render "reports/report_row", report: @report, show_project: true, row_class: row_class %>
<% end %>
<%# 2. Update the Status Badge (for Show) %>
<%= turbo_stream.replace "report_status_container" do %>
  <% status_style = @report.status_reviewed? ? 'bg-green-500' : (@report.status_submitted? ? 'bg-blue-500' : 'bg-brand-primary') %>
  <span class="inline-flex items-center gap-1.5 text-[9px] font-black uppercase tracking-widest text-brand-secondary/50 dark:text-brand-primary/50">
    <span class="h-1.5 w-1.5 rounded-full <%= status_style %> <%= 'animate-pulse' if @report.status_submitted? %>"></span>
    <%= @report.status.humanize %>
  </span>
<% end %>
<%# 3. Update the Action Buttons (for Show) %>
<%= turbo_stream.replace dom_id(@report, :actions) do %>
  <div id="<%= dom_id(@report, :actions) %>" class="flex flex-wrap gap-2">
    <% if policy(@report).submit? %>
      <%= button_to submit_project_report_path(@report.project, @report), method: :patch, class: "px-4 py-2 rounded-xl bg-blue-600 text-white text-[10px] font-black uppercase tracking-widest shadow-lg hover:bg-blue-700 transition-all active:scale-95 cursor-pointer" do %>
        Submit for Review
      <% end %>
    <% end %>
    <% if policy(@report).review? %>
      <%= button_to review_project_report_path(@report.project, @report), method: :patch, class: "px-4 py-2 rounded-xl bg-green-600 text-white text-[10px] font-black uppercase tracking-widest shadow-lg hover:bg-green-700 transition-all active:scale-95 cursor-pointer" do %>
        Approve Log
      <% end %>
    <% end %>
    <%= link_to edit_project_report_path(@report.project, @report), class: "p-2.5 rounded-xl bg-brand-primary text-white hover:bg-brand-black transition-all shadow-md" do %>
      <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
        <path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
      </svg>
    <% end %>
    <% if policy(@report).destroy? %>
      <button type="button"
      data-action="click->confirm-modal#open"
        data-confirm-modal-varient-param="danger"
        data-confirm-modal-title-param="Delete Report"
        data-confirm-modalmessage-param="Are you sure you want to delete this report? This action cannot be undone."
        data-confirm-modal-confirm-path-param="<%= project_report_path(@report.project, @report) %>"
        class="p-2.5 rounded-xl bg-red-600 text-white hover:bg-red-700 transition-all shadow-md">
        <svg xmlns="http://www.w3.org/200/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
        </svg>
      </button>
    <% end %>
  </div>
<% end %>
<%# 4. Standard Flash Notification %>
<%= turbo_stream.replace "flash" do %>
  <%= render "shared/flash" %>
<% end %>