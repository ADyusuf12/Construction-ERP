<% content_for :title, "#{@warehouse.name} | Logistics Hub" %>
<div class="bg-brand-white/30 dark:bg-brand-black/30 backdrop-blur-md border border-brand-secondary/20 rounded-2xl shadow-2xl p-8 mb-8 relative overflow-hidden animate-fade-in">
    <div class="absolute top-0 left-0 w-full h-1 bg-brand-primary opacity-40"></div>
    <div class="flex flex-col md:flex-row justify-between items-start gap-6">
        <div class="flex-1">
            <div class="flex items-center gap-3 mb-2">
                <span class="px-2 py-0.5 rounded bg-brand-primary/10 border border-brand-primary/20 text-[9px] font-black uppercase tracking-[0.2em] text-brand-primary">
                    Hub Code: <%= @warehouse.code.presence || "N/A" %>
                </span>
                <span class="inline-flex items-center gap-1.5 text-[9px] font-black uppercase tracking-widest text-brand-secondary/50 dark:text-brand-primary/50">
                    <span class="h-1.5 w-1.5 rounded-full bg-green-500 animate-pulse"></span>
                    Operational
                </span>
            </div>
            <h2 class="text-3xl font-black text-brand-secondary dark:text-white uppercase tracking-tighter italic mb-4">
                <%= @warehouse.name %>
            </h2>
            <p class="text-sm text-brand-secondary/70 dark:text-white/70 leading-relaxed max-w-2xl italic border-l-2 border-brand-primary/30 pl-4">
                <%= @warehouse.address.presence || "No physical address registered for this site." %>
            </p>
        </div>
        <div class="flex flex-wrap md:flex-nowrap gap-3">
            <%= link_to edit_inventory_warehouse_path(@warehouse),
          class: "flex items-center gap-2 px-5 py-2.5 rounded-xl bg-brand-primary text-white text-[10px] font-black uppercase tracking-widest shadow-lg hover:bg-brand-black transition-all active:scale-95" do %>
            Update Hub
            <% end %>
            <%= link_to inventory_warehouses_path,
          class: "flex items-center gap-2 px-5 py-2.5 rounded-xl bg-brand-secondary/10 text-brand-secondary dark:text-white border border-brand-secondary/20 text-[10px] font-black uppercase tracking-widest hover:bg-brand-secondary hover:text-white transition-all" do %>
            Warehouse Directory
            <% end %>
        </div>
    </div>
    <div class="grid grid-cols-1 sm:grid-cols-3 gap-8 mt-10 pt-8 border-t border-brand-secondary/10">
        <div>
            <p class="text-[9px] font-black uppercase tracking-[0.2em] text-brand-primary mb-2">Total SKU Count</p>
            <p class="text-2xl font-black text-brand-secondary dark:text-white font-mono tracking-tighter">
                <%= @inventory_items.count %> <span class="text-[10px] font-bold opacity-40">ITEMS</span>
            </p>
        </div>
        <div>
            <p class="text-[9px] font-black uppercase tracking-[0.2em] text-brand-primary mb-2">Valuation (On-Hand)</p>
            <p class="text-2xl font-black text-brand-secondary dark:text-white font-mono tracking-tighter text-green-600/90">
                <%= number_to_currency(@warehouse.total_stock_value, unit: "â‚¦") %>
            </p>
        </div>
        <div>
            <p class="text-[9px] font-black uppercase tracking-[0.2em] text-brand-primary mb-2">Deployment Activity</p>
            <p class="text-sm font-bold text-brand-secondary dark:text-white uppercase tracking-tight">
                <%= @recent_movements.count %> <span class="opacity-60 italic">Movements logged recently</span>
            </p>
        </div>
    </div>
</div>
<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <div class="lg:col-span-2 space-y-6">
        <div class="flex items-center justify-between">
            <h2 class="text-sm font-black text-brand-secondary dark:text-white uppercase tracking-widest">
                Active Stock Levels
            </h2>
        </div>
        <div class="overflow-hidden bg-brand-white/20 dark:bg-brand-black/20 backdrop-blur-sm border border-brand-secondary/10 rounded-2xl">
            <%= render "inventory/inventory_items/inventory_table",
                 inventory_items: @inventory_items,
                 inventory_totals: @inventory_totals %>
        </div>
    </div>
    <div class="space-y-6">
        <h2 class="text-sm font-black text-brand-secondary dark:text-white uppercase tracking-widest">
            Recent Movements
        </h2>
        <div class="space-y-4">
            <% if @recent_movements.any? %>
            <% @recent_movements.each do |movement| %>
            <div class="p-4 rounded-xl border border-brand-secondary/10 bg-brand-white/30 dark:bg-brand-black/30 hover:border-brand-primary/40 transition-all group">
                <div class="flex justify-between items-start mb-2">
                    <span class="text-[8px] font-black px-1.5 py-0.5 rounded border <%= movement.movement_type == 'inbound' ? 'bg-green-500/10 text-green-600 border-green-500/20' : 'bg-red-500/10 text-red border-red-500/20' %> uppercase">
                        <%= movement.movement_type %>
                    </span>
                    <span class="text-[9px] font-mono text-brand-secondary/40 dark:text-white/40"><%= l(movement.created_at, format: :short) %></span>
                </div>
                <p class="text-xs font-black text-brand-secondary dark:text-white uppercase tracking-tight truncate">
                    <%= movement.inventory_item.name %>
                </p>
                <div class="mt-2 flex items-center justify-between border-t border-brand-secondary/5 pt-2">
                    <span class="text-xs font-mono font-black text-brand-primary">QTY: <%= movement.quantity %></span>
                    <span class="text-[9px] font-bold text-brand-secondary/50 dark:text-white/40 italic">
                        By: <%= movement.performed_by&.full_name&.split&.first || "System" %>
                    </span>
                </div>
            </div>
            <% end %>
            <% else %>
            <div class="py-10 text-center border-2 border-dashed border-brand-secondary/10 rounded-2xl">
                <p class="text-[10px] font-black uppercase text-brand-secondary/30 tracking-widest text-center">No Movements Logged</p>
            </div>
            <% end %>
        </div>
    </div>
</div>