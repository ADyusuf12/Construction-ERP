<% content_for :title, "Attendance: #{@attendance_record.employee.full_name} | HR" %>
<div class="bg-brand-white/30 dark:bg-brand-black/30 backdrop-blur-md border border-brand-secondary/20 rounded-2xl shadow-2xl p-8 mb-8 relative overflow-hidden animate-fade-in">
  <%
    status_bg = case @attendance_record.status
      when 'present' then 'bg-green-500'
      when 'absent' then 'bg-red-500'
      when 'late' then 'bg-yellow-500'
      when 'on_leave' then 'bg-blue-500'
      else 'bg-gray-500'
    end
  %>
  <div class="absolute top-0 left-0 w-full h-1 <%= status_bg %> opacity-40"></div>
  <div class="flex flex-col md:flex-row justify-between items-start gap-6">
    <div class="flex-1">
      <div class="flex items-center gap-3 mb-2">
        <span class="px-2 py-0.5 rounded bg-brand-secondary/10 border border-brand-secondary/20 text-[9px] font-black uppercase tracking-[0.2em] text-brand-secondary dark:text-brand-primary">
          Daily Log #<%= @attendance_record.id %>
        </span>
        <span class="inline-flex items-center gap-1.5 text-[9px] font-black uppercase tracking-widest <%= status_bg.gsub('bg-', 'text-') %>">
          <span class="h-1.5 w-1.5 rounded-full <%= status_bg %>"></span>
          <%= @attendance_record.status.humanize %>
        </span>
      </div>
      <h2 class="text-3xl font-black text-brand-secondary dark:text-white uppercase tracking-tighter italic mb-1">
        <%= @attendance_record.employee.full_name %>
      </h2>
      <p class="text-sm font-bold text-brand-primary uppercase tracking-[0.1em]">
        <%= @attendance_record.project.name %>
      </p>
    </div>
    <div class="flex flex-wrap md:flex-nowrap gap-3">
      <%= link_to edit_hr_attendance_record_path(@attendance_record),
          class: "flex items-center gap-2 px-5 py-2.5 rounded-xl bg-brand-secondary text-white text-[10px] font-black uppercase tracking-widest shadow-lg hover:bg-brand-primary transition-all active:scale-95" do %>
        Modify Entry
      <% end %>
      <%= link_to hr_attendance_records_path,
          class: "flex items-center gap-2 px-5 py-2.5 rounded-xl bg-brand-secondary/10 text-brand-secondary dark:text-white border border-brand-secondary/20 text-[10px] font-black uppercase tracking-widest hover:bg-brand-secondary hover:text-white transition-all" do %>
        Log History
      <% end %>
      <% if policy(@attendance_record).destroy? %>
        <%= button_to "#",
            class: "p-2.5 rounded-xl bg-red-500/10 text-red-600 border border-red-500/20 hover:bg-red-600 hover:text-white transition-all cursor-pointer",
            form: {
              "data-action" => "click->confirm-delete#open",
              "data-confirm-delete-title-param" => "Void Record?",
              "data-confirm-delete-message-param" => "This will remove the attendance record for #{@attendance_record.employee.full_name} on #{@attendance_record.date.strftime('%B %d')}. Proceed?",
              "data-confirm-delete-confirm-path-param" => hr_attendance_record_path(@attendance_record)
            } do %>
          <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
          </svg>
        <% end %>
      <% end %>
    </div>
  </div>
  <div class="mt-10 p-6 rounded-2xl bg-brand-secondary/5 dark:bg-white/5 border border-brand-secondary/10">
    <div class="flex flex-col md:flex-row items-center justify-between gap-8">
      <div class="text-center md:text-left">
        <p class="text-[8px] font-black uppercase tracking-widest text-brand-primary mb-1">Shift Start</p>
        <p class="text-2xl font-black text-brand-secondary dark:text-white font-mono tracking-tighter">
          <%= @attendance_record.check_in_time&.strftime("%H:%M") || "—:—" %>
        </p>
      </div>
      <div class="flex-1 flex items-center gap-4 w-full md:w-auto">
        <div class="h-[2px] flex-1 bg-brand-secondary/20 dark:bg-white/20 relative">
          <% if @attendance_record.check_in_time && @attendance_record.check_out_time %>
            <div class="absolute inset-y-0 left-0 bg-brand-primary" style="width: 100%"></div>
          <% end %>
        </div>
        <div class="text-[10px] font-mono font-black text-brand-primary whitespace-nowrap px-3 py-1 rounded-full border border-brand-primary/30 bg-brand-primary/5">
          <% if @attendance_record.check_in_time && @attendance_record.check_out_time %>
            <%= ((@attendance_record.check_out_time - @attendance_record.check_in_time) / 3600).round(1) %> HRS
          <% else %>
            PENDING
          <% end %>
        </div>
        <div class="h-[2px] flex-1 bg-brand-secondary/20 dark:bg-white/20"></div>
      </div>
      <div class="text-center md:text-right">
        <p class="text-[8px] font-black uppercase tracking-widest text-brand-primary mb-1">Shift End</p>
        <p class="text-2xl font-black text-brand-secondary dark:text-white font-mono tracking-tighter">
          <%= @attendance_record.check_out_time&.strftime("%H:%M") || "—:—" %>
        </p>
      </div>
    </div>
  </div>
  <div class="grid grid-cols-1 sm:grid-cols-2 gap-8 mt-8 pt-8 border-t border-brand-secondary/10">
    <div>
      <p class="text-[9px] font-black uppercase tracking-[0.2em] text-brand-primary mb-2">Recording Date</p>
      <p class="text-sm font-black text-brand-secondary dark:text-white font-mono tracking-tighter uppercase">
        <%= @attendance_record.date.strftime("%A, %B %d, %Y") %>
      </p>
    </div>
    <div class="sm:text-right">
      <p class="text-[9px] font-black uppercase tracking-[0.2em] text-brand-primary mb-2">Accountability</p>
      <p class="text-xs font-bold text-brand-secondary/60 dark:text-white/60 italic">
        Verified by Site Supervisor
      </p>
    </div>
  </div>
</div>